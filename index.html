<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£—á–µ—Ç —Ä–µ—Å—É—Ä—Å–æ–≤ - IntoGroup Bitrix24</title>
    <script src="//api.bitrix24.com/api/v1/"></script>
    <link rel="stylesheet" href="style.css">
    <style>
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã –ü–ª–∞–Ω/–§–∞–∫—Ç ‚Äî –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è –Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ JS –Ω–µ —É—Å–ø–µ–µ—Ç –≤—Å—Ç–∞–≤–∏—Ç—å */
        .project-header {
            background-color: #e3f2fd;
            font-weight: bold;
            border-bottom: 2px solid #1976d2;
        }
        .user-header {
            background-color: #f5f5f5;
            font-weight: bold;
            border-bottom: 1px solid #ddd;
        }
        .summary-row {
            background-color: #fff3e0;
            font-weight: bold;
        }
        .overplan {
            color: #d32f2f;
        }
        .underplan {
            color: #388e3c;
        }
        .project-total {
            background-color: #4caf50;
            color: white;
        }
        .level-0 { background-color: #ffffff; }
        .level-1 { background-color: #f9f9f9; }
        .level-2 { background-color: #f0f0f0; }
        .level-3 { background-color: #e8e8e8; }
    </style>
</head>
<body>
    <div class="bx-app">
        <!-- –ó–∞–≥—Ä—É–∑—á–∏–∫ -->
        <div id="loader" class="loader">
            <div class="loader-spinner"></div>
            <p>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Bitrix24...</p>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å -->
        <div id="app" class="app-container" style="display: none;">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
            <div class="app-header">
                <h1>üìä –£—á–µ—Ç —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</h1>
                <div class="header-actions">
                    <button id="refresh-btn" class="bx-btn bx-btn-sm">
                        üîÑ –û–±–Ω–æ–≤–∏—Ç—å
                    </button>
                </div>
            </div>

            <!-- –§–∏–ª—å—Ç—Ä—ã -->
            <div class="filters-panel">
                <div class="filter-group">
                    <label>üìÖ –ü–µ—Ä–∏–æ–¥:</label>
                    <select id="period-filter" class="bx-select">
                        <option value="week">–ù–µ–¥–µ–ª—è</option>
                        <option value="month" selected>–ú–µ—Å—è—Ü</option>
                        <option value="quarter">–ö–≤–∞—Ä—Ç–∞–ª</option>
                        <option value="year">–ì–æ–¥</option>
                        <option value="custom">–ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π</option>
                    </select>
                </div>

                <div class="filter-group" id="custom-period" style="display: none;">
                    <label>–°:</label>
                    <input type="date" id="date-from" class="bx-input">
                    <label>–ü–æ:</label>
                    <input type="date" id="date-to" class="bx-input">
                </div>

                <div class="filter-group">
                    <label>üè¢ –ü—Ä–æ–µ–∫—Ç:</label>
                    <select id="project-filter" class="bx-select">
                        <option value="">–í—Å–µ –ø—Ä–æ–µ–∫—Ç—ã</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label>üë• –ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ:</label>
                    <select id="department-filter" class="bx-select">
                        <option value="">–í—Å–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è</option>
                    </select>
                </div>

                <div class="filter-group">
                    <button id="apply-filters" class="bx-btn bx-btn-primary">
                        –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
                    </button>
                </div>
            </div>

            <!-- –¢–∞–±–ª–∏—Ü—ã -->
            <div class="tabs">
                <button class="tab-btn active" data-tab="plan-fact">
                    üìà –ü–ª–∞–Ω/–§–∞–∫—Ç
                </button>
                <button class="tab-btn" data-tab="project-resources">
                    üîß –†–µ—Å—É—Ä—Å—ã –ø—Ä–æ–µ–∫—Ç–∞
                </button>
            </div>

            <div class="tab-content">
                <!-- –¢–∞–±–ª–∏—Ü–∞ –ü–ª–∞–Ω/–§–∞–∫—Ç -->
                <div id="plan-fact-tab" class="tab-pane active">
                    <div class="table-header">
                        <h2>–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–ª–∞–Ω–æ–≤—ã—Ö –∏ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö —Ç—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç</h2>
                        <button id="export-plan-fact" class="bx-btn bx-btn-success">
                            üìä –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
                        </button>
                    </div>
                    <div id="plan-fact-table" class="bx-table-container">
                        <table class="bx-table">
                            <thead>
                                <tr>
                                    <th>–ü—Ä–æ–µ–∫—Ç (–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ)</th>
                                    <th>–†–µ—Å—É—Ä—Å (–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ)</th>
                                    <th>–†–∞–±–æ—Ç–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–ó–∞–¥–∞—á–∏)</th>
                                    <th>–§–∞–∫—Ç –ß–∞—Å—ã</th>
                                    <th>–ü–ª–∞–Ω –ß–∞—Å—ã</th>
                                    <th>–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ</th>
                                </tr>
                            </thead>
                            <tbody id="plan-fact-body">
                                <tr>
                                    <td colspan="6" class="loading-text">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- –¢–∞–±–ª–∏—Ü–∞ –†–µ—Å—É—Ä—Å—ã –ø—Ä–æ–µ–∫—Ç–∞ -->
                <div id="project-resources-tab" class="tab-pane">
                    <div class="table-header">
                        <h2>–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ –ø–æ –ø—Ä–æ–µ–∫—Ç—É</h2>
                        <div class="controls">
                            <select id="detail-level" class="bx-select">
                                <option value="1">–£—Ä–æ–≤–µ–Ω—å 1 - –ó–∞–¥–∞—á–∏</option>
                                <option value="2">–£—Ä–æ–≤–µ–Ω—å 2 - –ü–æ–¥–∑–∞–¥–∞—á–∏</option>
                                <option value="3">–£—Ä–æ–≤–µ–Ω—å 3 - –î–µ—Ç–∞–ª—å–Ω–æ</option>
                            </select>
                            <button id="export-resources" class="bx-btn bx-btn-success">
                                üìä –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
                            </button>
                        </div>
                    </div>
                    <div id="project-resources-table" class="bx-table-container">
                        <table class="bx-table">
                            <thead>
                                <tr>
                                    <th>–ü—Ä–æ–µ–∫—Ç</th>
                                    <th>–°–æ—Ç—Ä—É–¥–Ω–∏–∫</th>
                                    <th>–ó–∞–¥–∞—á–∞</th>
                                    <th>–ü–æ–¥–∑–∞–¥–∞—á–∞</th>
                                    <th>–§–∞–∫—Ç (—á–∞—Å—ã)</th>
                                    <th>–ü–ª–∞–Ω (—á–∞—Å—ã)</th>
                                </tr>
                            </thead>
                            <tbody id="resources-body">
                                <tr>
                                    <td colspan="6" class="loading-text">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—à–∏–±–∫–∏ -->
        <div id="error-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <h3>‚ö†Ô∏è –û—à–∏–±–∫–∞</h3>
                <p id="error-message"></p>
                <button class="bx-btn" onclick="app.hideError()">
                    –ó–∞–∫—Ä—ã—Ç—å
                </button>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ -->
        <div id="info-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <h3>‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                <p id="info-message"></p>
                <button class="bx-btn" onclick="app.hideInfo()">
                    –û–ö
                </button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>